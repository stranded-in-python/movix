# –ë–∏–ª–ª–∏–Ω–≥

## –ë–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

–ù—É–∂–Ω—ã –¥–≤–∞ –º–µ—Ç–æ–¥–∞ —Ä–∞–±–æ—Ç—ã —Å –∫–∞—Ä—Ç–∞–º–∏: –æ–ø–ª–∞—Ç–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –∏ –≤–µ—Ä–Ω—É—Ç—å –∑–∞ –Ω–µ—ë –¥–µ–Ω—å–≥–∏. 
–°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —É—Å—Ç–æ–π—á–∏–≤–æ–π –∫ –ø–µ—Ä–µ–±–æ—è–º: –Ω—É–∂–Ω–æ, 
—á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –¥–≤–æ–π–Ω—ã—Ö —Å–ø–∏—Å–∞–Ω–∏–π, –∏ —á—Ç–æ–±—ã –æ–ø–µ—Ä–∞—Ü–∏—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –≤—ã–ø–æ–ª–Ω–∏–ª–∞—Å—å. 
–ù—É–∂–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∞–¥–º–∏–Ω–∫–æ–π Django: –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Å—Ç–∞—Ç—É—Å—ã –ø–æ–¥–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ –∞–¥–º–∏–Ω–∫–µ, (???).
–ù—É–∂–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ª–µ–≥–∫–æ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —ç–∫–≤–∞–π—Ä–∏–Ω–≥–∏, –Ω–µ–ª—å–∑—è –∑–∞–≤—è–∑—ã–≤–∞—Ç—å—Å—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.

### –ò—Å—Ç–æ—Ä–∏—è: "–ü–æ–¥–ø–∏—Å–∫–∞"
**–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**:

–Ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å. –Ø –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª—Å—è, –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª —Å–≤–æ—é —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å. 
–ú–Ω–µ –Ω—É–∂–Ω–æ –æ–ø–ª–∞—Ç–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—É –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä–∞.

**–î–µ–π—Å—Ç–≤–∏—è**: 

- –Ø –∂–º—É "–û–ø–ª–∞—Ç–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É".
- –ü–æ–ø–∞–¥–∞—é –Ω–∞ —Ñ–æ—Ä–º—É —Å –≤—ã–±–æ—Ä–æ–º –ø–ª–∞–Ω–∞ –æ–ø–ª–∞—Ç—ã (–ø–æ–º–µ—Å—è—á–Ω—ã–π / –¢—Ä–∏ –º–µ—Å—è—Ü–∞ / –ü–æ–ª—É–≥–æ–¥–æ–≤–æ–π / –≥–æ–¥–æ–≤–æ–π).
- –í—ã–±–∏—Ä–∞—é –µ–≥–æ, (–≤–æ–∑–º–æ–∂–Ω–æ, –≤–≤–æ–∂—É —Å—Ä–µ–¥—Å—Ç–≤–æ –æ–ø–ª–∞—Ç—ã)
- –ñ–º—É "–æ–ø–ª–∞—Ç–∏—Ç—å"
- –ü–æ–ø–∞–¥–∞—é –Ω–∞ —ç–∫–≤–∞–π—Ä–∏–Ω–≥
- –í–∏–∂—É —Å—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞
- –í–æ–∑–≤—Ä–∞—â–∞—é—Å—å –≤ –ª–∫
- –ò–¥—É —Å–º–æ—Ç—Ä–µ—Ç—å –∫–∏–Ω–æ üé•

### –ò—Å—Ç–æ—Ä–∏—è: "–û—Ç–º–µ–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∏"

**–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**

–Ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å. –Ø –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω, —É –º–µ–Ω—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–∞—è —É—á–µ—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å, 
–∞ —Ç–∞–∫–∂–µ —É –º–µ–Ω—è –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞.
–Ø —Ö–æ—á—É –≤–µ—Ä–Ω—É—Ç—å –¥–µ–Ω—å–≥–∏ –∑–∞ –Ω–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Å—è—Ü—ã –ø–æ–¥–ø–∏—Å–∫–∏.
–ï—Å–ª–∏ –ø–æ–¥–ø–∏—Å–∫–∞ –±—ã–ª–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∞ –º–µ–Ω–µ–µ —á–∞—Å–∞ –Ω–∞–∑–∞–¥, —Ç–æ —è –≤–æ–∑–≤—Ä–∞—â–∞—é –¥–µ–Ω—å–≥–∏ –∏ –∑–∞ —ç—Ç–æ—Ç –º–µ—Å—è—Ü —Ç–æ–∂–µ (?).

**–î–µ–π—Å—Ç–≤–∏—è**:

- –Ø –∂–º—É –Ω–∞ –∫–Ω–æ–ø–∫—É "–û—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É". 
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é —Å–≤–æ—ë —Ä–µ—à–µ–Ω–∏–µ
- –ø–æ–¥–ø–∏—Å–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞.

### –ò—Å—Ç–æ—Ä–∏—è: "–ö–æ–Ω—Ç—Ä–æ–ª—å –ø–æ–¥–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"

**–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**

–Ø –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä. –Ø —Ö–æ—á—É:

- –í–∏–¥–µ—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –í–∏–¥–µ—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –ø–ª–∞—Ç–µ–∂–∞–º: –≤—Ä–µ–º—è —Å–æ–≤–µ—Ä—à–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, —Å—Ä–æ–∫ –ø–æ–¥–ø–∏—Å–∫–∏, —Ç–∏–ø –ø–æ–¥–ø–∏—Å–∫–∏

**–î–µ–π—Å—Ç–≤–∏—è:**

- –Ø –∑–∞—Ö–æ–∂—É –≤ –∞–¥–º–∏–Ω–∫—É
- –ù–∞—Ö–æ–∂—É –Ω—É–∂–Ω–æ–≥–æ –º–Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤–∏–∂—É —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏
- –ü—Ä–æ–≤–∞–ª–∏–≤–∞—é—Å—å –≤ –ø–ª–∞—Ç–µ–∂–∏/–∏–ª–∏ –≤–∏–∂—É –∏—Ö –Ω–∞ —ç–∫—Ä–∞–Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### Service Architecture

#### General Architecture

https://gist.github.com/SBKubric/2442c48395b0fbebbd8d968cd3dea4ae

#### User Stories
##### Suscription
![–î–∏–∞–≥—Ä–∞–º–º–∞_–±–µ–∑_–Ω–∞–∑–≤–∞–Ω–∏—è_–°—Ç—Ä–∞–Ω–∏—Ü–∞_‚Äî_2](https://user-images.githubusercontent.com/5788811/269678885-467a0ebe-c776-46cf-aff0-b0162583d070.jpg)

##### Refund
![image](https://user-images.githubusercontent.com/5788811/270385919-937b7f55-4dff-4704-9b2b-d22973a6fe53.png)

#### Recurring subscription

–£—Ç–æ—á–Ω–∏—Ç—å –∑–∞–¥–∞—á—É, –Ω–∞–¥–æ –≤—ã—è—Å–Ω–∏—Ç—å, –µ—Å—Ç—å –ª–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∞–Ω–∏–µ–º –≤–º–µ—Å—Ç–æ –ø–ª–∞–Ω–∞, –∏ –∫–∞–∫ –±—ã—Ç—å, –µ—Å–ª–∏ –º—ã –Ω–µ —É–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–º–µ–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏

https://developers.cloudpayments.ru/#platezhi-po-podpiske

### –°—É—â–Ω–æ—Å—Ç–∏

#### Subscription plan

- id
- subscription type
- sum
- currency
- months

#### Subscription

- id
- status
- user_id
- plan_id
- type
- valid_till

#### Payment

- id
- subscription_id
- status
- extra: {–¥–∞–Ω–Ω—ã–µ —ç–∫–≤–∞–π—Ä–∏–Ω–≥–∞, —á—Ç–æ-—Ç–æ –µ—â—ë}
- user_id
- sum
- currency

#### Refund

- id
- status
- subscription_id
- extra: {–¥–∞–Ω–Ω—ã–µ —ç–∫–≤–∞–π—Ä–∏–Ω–≥–∞, —á—Ç–æ-—Ç–æ –µ—â—ë}
- user_id
- sum
- currency

### –í–Ω–µ—à–Ω–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: API

#### Subscription
MVP:
- GET subscriptions/
- GET subscriptions/<subscription_id>
- GET subscription/<subscription_id>/payments
- POST subcriptions/subscribe
- POST subscription/unsubscribe
Backlog:
- GET subscription/plans/<plan_id>
- GET subscription/plans
- POST subscription/plans/new
- DELETE subscription/plans/<plan_id>

#### Payments
MVP:
- GET payments/<payment_id>
- GET payments/subscription/<subscription_id>
- POST payments/payment
- POST payments/refund
- POST payments/check
- POST payments/confirm

### –ê–¥–º–∏–Ω–∫–∞

[SQLAdmin](https://aminalaee.dev/sqladmin/)

### –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á

Payment-—Å–µ—Ä–≤–∏—Å: API (–ø–∏–∫)
- –ø—Ä–æ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç + –¥–æ–±–∞–≤–∏—Ç—å –µ–≥–æ –≤ movix-–∫–æ–Ω—Ñ–∏–≥–∏
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–±—ë—Ä—Ç–∫—É –Ω–∞–¥ API –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ [–í–∞—Ä–∏–∞–Ω—Ç –ø—Ä–∏–º–µ—Ä–∞](https://github.com/antidasoftware/cloudpayments-python-client/tree/master/cloudpayments)
- –û–ø–∏—Å–∞—Ç—å –º–æ–¥–µ–ª–∏ –ë–î –ø—Ä–∏ –ø–æ–º–æ—â–∏ sqlalchemy
- —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä—É—á–∫—É payment
- —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä—É—á–∫—É refund
- —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä—É—á–∫—É /payments/check
- —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä—É—á–∫—É

Payment-—Å–µ—Ä–≤–∏—Å: —à–µ–¥—É–ª–µ—Ä (–ø–∏–∫)
- –ø—Ä–æ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç + –¥–æ–±–∞–≤–∏—Ç—å –µ–≥–æ –≤ movix-–∫–æ–Ω—Ñ–∏–≥–∏
- –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞
- –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Ä–µ—Ñ–∞–Ω–¥–∞

Subscription-—Å–µ—Ä–≤–∏—Å (–ø–∏–∫)
- –ø—Ä–æ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç + –¥–æ–±–∞–≤–∏—Ç—å –µ–≥–æ –≤ movix-–∫–æ–Ω—Ñ–∏–≥–∏
- —Å–¥–µ–ª–∞—Ç—å mock-—Ä—É—á–∫–∏ –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
BACKLOG:
- —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä—É—á–∫—É subscriptions/subscribe
- —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä—É—á–∫—É subscriptions/unsubscribe
- ???

–ê–¥–º–∏–Ω–∫–∞ (–ø–∏–∫)
- –ø—Ä–æ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç + –¥–æ–±–∞–≤–∏—Ç—å –µ–≥–æ –≤ movix-–∫–æ–Ω—Ñ–∏–≥–∏
- —Å–æ–∑–¥–∞—Ç—å –∑–∞–≥–æ—Ç–æ–≤–∫—É –∞–¥–º–∏–Ω–∫–∏
- –¥–æ–±–∞–≤–∏—Ç—å –≤ –∞–¥–º–∏–Ω–∫—É –ø–æ–¥–ø–∏—Å–∫–∏
- –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∏—Å–∫ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- –¥–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ—Ñ–∞–Ω–¥—ã (?)

–î–æ–±–∞–≤–∏—Ç—å —Ä–æ–ª–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø–∏–∫)
- –¥–æ–±–∞–≤–∏—Ç—å —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ö–∞—Ä–¥–∫–æ–¥)
- –¥–æ–±–∞–≤–∏—Ç—å —Ä—É—á–∫—É –¥–ª—è –ø—Ä–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (is_superuser = True)

–î–æ–±–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–ø–∏–∫)
- —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ–ø–ª–∞—Ç–µ
- —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ä–µ—Ñ–∞–Ω–¥–µ
